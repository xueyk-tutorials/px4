# ROS2-dev



## micrortps_bridge

micrortps_bridge包括了micrortps_client和micrortps_agent两个部分。

### 编译

在构建PX4的目标程序的过程中生成了micrortps_client以及micrortps_agent的源程序。源程序分别放在`build/<target-platform>/src/modules/micrortps_bridge`目录下的**micrortps_client**和**micrortps_agent**子目录下。其中，`<target-platform>`可以是px4_sitl_rtps（软件仿真环境），也可以是px4_fmu-v5_rtps(pixhawk的固件)。

由于micrortps_agent是运行在机载计算机上的，除了可以在**PX4固件**构建时被编译外，也可以通过创建带有**px4_ros_com**包的ROS2工程进行编译。px4_ros_com源码中包括了micrortps_agent源码，在路径`px4_ros_com/src/micrortps_agent`。

## uORB messages

参考：https://docs.px4.io/main/en/middleware/micrortps.html

在client，消息定义在：`PX4-Autopilot/msg/tools/uorb_rtps_message_ids.yaml`。

内容如下：



在agent，消息定义在：`px4_ros_com/templates/urtps_bridge_topics.yaml`。

内容如下：

```yaml
# AUTOGENERATED-FILE! DO NOT MODIFY IT DIRECTLY.
# Edit instead the same file under PX4-Autopilot/msg/tools and use the 
# PX4-Autopilot/msg/tools/uorb_to_ros_urtps_topics.py to regenerate this file.
rtps:
  - msg: DebugArray
    receive: true
  - msg: DebugKeyValue
    receive: true
  - msg: DebugValue
    receive: true
  - msg: DebugVect
    receive: true
  - msg: OffboardControlMode
    receive: true
# ...
# ...
# ...
```

